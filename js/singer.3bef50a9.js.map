{"version":3,"sources":["webpack:///./src/views/singer.vue","webpack:///./src/service/singer.js","webpack:///./src/components/base/index-List/indexList.vue","webpack:///./src/components/base/index-List/use-fixed.js","webpack:///./src/components/base/index-List/use-shortcut.js","webpack:///./src/components/base/index-List/indexList.vue?5a64","webpack:///./src/views/singer.vue?22a2","webpack:///./src/components/base/index-List/indexList.vue?2610","webpack:///./node_modules/core-js/modules/es.array.map.js","webpack:///./src/views/singer.vue?1e8f"],"names":["class","data","singers","length","getSingerList","get","ref","probeType","onScroll","group","key","title","list","item","id","pic","name","style","fixedStyle","fixedTitle","onShortcutTouchStart","onShortcutTouchMove","shortcutList","index","currentIndex","data-index","useFixed","props","TITLE_HEIGHT","groupRef","listHeights","scrollY","distance","listHeightsVal","value","computed","distanceVal","diff","transform","currentGroup","caculate","children","height","push","i","clientHeight","pos","y","watch","nextTick","newY","heightTop","heightBottom","useShortcut","ANCHOR_HEIGHT","scrollRef","map","touch","e","anchorIndex","parseInt","target","dataset","y1","touches","pageY","scrollTo","y2","delta","isNaN","Math","max","min","targetEl","scroll","scrollToElement","components","Scroll","type","Array","default","setup","render","__scopeId","IndexList","Component","created","console","log","methods","selectSinger","$","$map","arrayMethodHasSpeciesSupport","HAS_SPECIES_SUPPORT","proto","forced","callbackfn","this","arguments","undefined"],"mappings":"8MACOA,MAAM,U,uJAAX,eAUM,MAVN,EAUM,CATJ,eAEc,GADXC,KAAM,EAAAC,SAAO,kB,WAFc,EAAAA,QAAQC,a,oCCCnC,SAASC,IACd,OAAOC,eAAI,sB,2FCDHC,IAAI,Y,GAEIN,MAAM,S,GAGqBA,MAAM,U,GACvBA,MAAM,Q,GAUvBA,MAAM,e,gIAjBf,eA0BS,GA1BDA,MAAM,aAAcO,UAAW,EAAI,SAAQ,EAAAC,SAAUF,IAAI,a,YAC7D,iBAUK,CAVL,eAUK,KAVL,EAUK,E,mBATD,eAQK,2BARe,EAAAL,MAAI,SAAbQ,G,wBAAX,eAQK,MARsBC,IAAKD,EAAME,MAAOX,MAAM,S,CAC/C,eAAsC,KAAtC,EAAsC,eAAlBS,EAAME,OAAK,GAC/B,eAKK,Y,mBAJD,eAGK,2BAHcF,EAAMG,MAAI,SAAlBC,G,wBAAX,eAGK,MAH2BH,IAAKG,EAAKC,GAAId,MAAM,Q,gBAChD,eAAsC,MAAtC,EAAsC,W,GAAzBa,EAAKE,OAClB,eAAuC,OAAvC,EAAuC,eAAlBF,EAAKG,MAAI,Q,wCAKhD,eAMM,OALJhB,MAAM,QAELiB,MAAO,EAAAC,Y,CAER,eAA6C,MAA7C,EAA6C,eAAlB,EAAAC,YAAU,I,YAH7B,EAAAA,cAKV,eAMM,OANDnB,MAAM,WACV,aAAU,8CAAe,EAAAoB,sBAAA,EAAAA,qBAAA,qBAAoB,qBAC7C,YAAS,8CAAe,EAAAC,qBAAA,EAAAA,oBAAA,qBAAmB,qBAC3C,WAAQ,4BAAT,cAAsB,sB,CACpB,eACsC,Y,mBADlC,eAC6B,2BADF,EAAAC,cAAY,SAA3BT,EAAKU,G,wBAAjB,eAC6B,MADab,IAAKG,EAAMb,MAAK,CAAC,OAAM,SAAkB,EAAAwB,eAAeD,IACrGE,aAAYF,G,eAASV,GAAI,sB,qDCxBjB,SAASa,EAAUC,GAChC,IAAMC,EAAe,GACfC,EAAWvB,eAAI,MACfwB,EAAcxB,eAAI,IAClByB,EAAUzB,eAAI,GACdkB,EAAelB,eAAI,GACnB0B,EAAW1B,eAAI,GACf2B,EAAiBH,EAAYI,MAE7BhB,EAAaiB,gBAAS,WAC1B,IAAMC,EAAcJ,EAASE,MACvBG,EAAQD,EAAc,GAAKA,EAAcR,EAAgBQ,EAAcR,EAAe,EAC5F,MAAO,CACLU,UAAW,iBAAF,OAAmBD,EAAnB,aAGPlB,EAAagB,gBAAS,WAC1B,GAAIJ,EAAQG,MAAQ,EAClB,MAAO,GAET,IAAMK,EAAeZ,EAAM1B,KAAKuB,EAAaU,OAC7C,OAAOK,EAAeA,EAAa5B,MAAQ,MAgB7C,SAAS6B,IACP,IAAM5B,EAAOiB,EAASK,MAAMO,SAExBC,EAAS,EACbT,EAAe9B,OAAS,EACxB8B,EAAeU,KAAKD,GAEpB,IAAK,IAAIE,EAAI,EAAGA,EAAIhC,EAAKT,OAAQyC,IAC/BF,GAAU9B,EAAKgC,GAAGC,aAClBZ,EAAeU,KAAKD,GAGxB,SAASlC,EAAUsC,GACjBf,EAAQG,OAASY,EAAIC,EAEvB,OA7BAC,gBAAM,kBAAMrB,EAAM1B,OAAb,wCAAmB,8GAChBgD,iBADgB,OAEtBT,IAFsB,4CAIxBQ,eAAMjB,GAAS,SAACmB,GACd,IAAK,IAAIN,EAAI,EAAGA,EAAIX,EAAe9B,OAAS,EAAGyC,IAAK,CAClD,IAAMO,EAAYlB,EAAeW,GAC3BQ,EAAenB,EAAeW,EAAI,GACpCM,GAAQC,GAAaD,GAAQE,IAC/B5B,EAAaU,MAAQU,EACrBZ,EAASE,MAAQkB,EAAeF,OAmB/B,CAAErB,WAAUrB,WAAUW,aAAYK,eAAcN,c,sCCnD1C,SAASmC,EAAa1B,EAAOE,GAC1C,IAAMyB,EAAgB,GAChBC,EAAYjD,eAAI,MAChBgB,EAAea,gBAAS,WAC5B,OAAOR,EAAM1B,KAAKuD,KAAI,SAAC/C,GACrB,OAAOA,EAAME,YAGX8C,EAAQ,GACd,SAASrC,EAAsBsC,GAC7B,IAAMC,EAAcC,SAASF,EAAEG,OAAOC,QAAQvC,OAC9CkC,EAAME,YAAcA,EACpBF,EAAMM,GAAKL,EAAEM,QAAQ,GAAGC,MACxBC,EAASP,GAEX,SAAStC,EAAqBqC,GAC5BD,EAAMU,GAAKT,EAAEM,QAAQ,GAAGC,MACxB,IAAMG,GAASX,EAAMU,GAAKV,EAAMM,IAAMT,EAAgB,EAChDK,EAAcF,EAAME,YAAcS,EACxCF,EAASP,GAEX,SAASO,EAAU3C,GACjB,IAAI8C,MAAM9C,GAAV,CAGAA,EAAQ+C,KAAKC,IAAI,EAAGD,KAAKE,IAAIlD,EAAaY,MAAM/B,OAAS,EAAGoB,IAC5D,IAAMkD,EAAW5C,EAASK,MAAMO,SAASlB,GACnCmD,EAASnB,EAAUrB,MAAMwC,OAC/BA,EAAOC,gBAAgBF,EAAU,IAEnC,MAAO,CAAEnD,eAAcF,uBAAsBmC,YAAWlC,uBFC3C,OACbL,KAAM,aACN4D,WAAY,CAAEC,OAAA,QACdlD,MAAO,CACL1B,KAAM,CACJ6E,KAAMC,MACNC,QAFI,WAGF,MAAO,MAIbC,MAXa,SAWNtD,GACL,MAAqED,EAASC,GAAtEE,EAAR,EAAQA,SAAUrB,EAAlB,EAAkBA,SAAUW,EAA5B,EAA4BA,WAAYK,EAAxC,EAAwCA,aAAcN,EAAtD,EAAsDA,WACtD,EAA+EmC,EAAY1B,EAAOE,GAA1FP,EAAR,EAAQA,aAAciC,EAAtB,EAAsBA,UAAWnC,EAAjC,EAAiCA,qBAAsBC,EAAvD,EAAuDA,oBACvD,MAAO,CAAEQ,WAAUrB,WAAUW,aAAYK,eAAcN,aAAYI,eAAcF,uBAAsBC,sBAAqBkC,e,UG1ChI,EAAO2B,OAAS,EAChB,EAAOC,UAAY,kBAEJ,QLSA,GACbP,WAAY,CACVQ,UAAA,GAEFnF,KAJa,WAKX,MAAO,CACLC,QAAS,GACTmF,UAAW,KAGTC,QAVO,WAUI,8KACIlF,IADJ,OACTH,EADS,OAEfsF,QAAQC,IAAIvF,GACZ,EAAKC,QAAUD,EAAKC,QAHL,8CAKjBuF,QAAS,CACPC,aADO,e,UM3BX,EAAOR,OAASA,EAChB,EAAOC,UAAY,kBAEJ,gB,kCCRf,W,yDCCA,IAAIQ,EAAI,EAAQ,QACZC,EAAO,EAAQ,QAAgCpC,IAC/CqC,EAA+B,EAAQ,QAEvCC,EAAsBD,EAA6B,OAKvDF,EAAE,CAAE9B,OAAQ,QAASkC,OAAO,EAAMC,QAASF,GAAuB,CAChEtC,IAAK,SAAayC,GAChB,OAAOL,EAAKM,KAAMD,EAAYE,UAAUhG,OAAS,EAAIgG,UAAU,QAAKC,O,kCCZxE,W","file":"js/singer.3bef50a9.js","sourcesContent":["<template>\r\n  <div class=\"singer\" v-loading=\"!singers.length\">\r\n    <index-list\r\n      :data=\"singers\"\r\n    ></index-list>\r\n      <!-- @select=\"selectSinger\" -->\r\n    <!-- <router-view v-slot=\"{ Component }\">\r\n      <transition appear name=\"slide\">\r\n        <component :is=\"Component\" :data=\"selectedSinger\"/>\r\n      </transition>\r\n    </router-view> -->\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { getSingerList } from '@/service/singer'\r\nimport IndexList from '@/components/base/index-List/indexList.vue'\r\nexport default {\r\n  components: {\r\n    IndexList\r\n  },\r\n  data () {\r\n    return {\r\n      singers: [],\r\n      Component: {}\r\n    }\r\n  },\r\n  async created () {\r\n    const data = await getSingerList()\r\n    console.log(data)\r\n    this.singers = data.singers\r\n  },\r\n  methods: {\r\n    selectSinger () {}\r\n  }\r\n\r\n}\r\n</script>\r\n\r\n<style lang='scss' scoped>\r\n.singer{\r\n  position: fixed;\r\n  top: 88px;\r\n  bottom: 0;\r\n  width: 100%;\r\n}\r\n</style>\r\n","import { get } from './base'\r\n\r\nexport function getSingerList () {\r\n  return get('/api/getSingerList')\r\n}\r\n\r\nexport function getSingerDetail (singer) {\r\n  return get('/api/getSingerDetail', {\r\n    mid: singer.mid\r\n  })\r\n}\r\n","<template>\r\n  <scroll class=\"index-list\" :probeType=\"3\" @scroll=\"onScroll\" ref=\"scrollRef\">\r\n      <ul ref=\"groupRef\">\r\n          <li v-for=\"group in data\" :key=\"group.title\" class=\"group\">\r\n              <h2 class=\"title\">{{group.title}}</h2>\r\n              <ul>\r\n                  <li v-for=\"item in group.list\" :key=\"item.id\" class=\"item\">\r\n                      <img v-lazy=\"item.pic\" class=\"avatar\">\r\n                      <span class=\"name\">{{item.name}}</span>\r\n                  </li>\r\n              </ul>\r\n          </li>\r\n      </ul>\r\n    <div\r\n      class=\"fixed\"\r\n      v-show=\"fixedTitle\"\r\n      :style=\"fixedStyle\"\r\n    >\r\n      <div class=\"fixed-title\">{{fixedTitle}}</div>\r\n    </div>\r\n    <div class=\"shortcut\"\r\n    @touchstart.stop.prevent=\"onShortcutTouchStart\"\r\n    @touchmove.stop.prevent=\"onShortcutTouchMove\"\r\n    @touchend.stop.prevent>\r\n      <ul><li v-for=\"(item,index) in shortcutList\" :key=\"item\" class=\"item\" :class=\"{current:currentIndex===index}\"\r\n      :data-index=\"index\">{{item}}</li></ul>\r\n    </div>\r\n  </scroll>\r\n</template>\r\n<script>\r\nimport Scroll from '@/components/base/scroll/scroll'\r\nimport useFixed from './use-fixed'\r\nimport useShortcut from './use-shortcut'\r\nexport default {\r\n  name: 'index-list',\r\n  components: { Scroll },\r\n  props: {\r\n    data: {\r\n      type: Array,\r\n      default () {\r\n        return []\r\n      }\r\n    }\r\n  },\r\n  setup (props) {\r\n    const { groupRef, onScroll, fixedTitle, currentIndex, fixedStyle } = useFixed(props)\r\n    const { shortcutList, scrollRef, onShortcutTouchStart, onShortcutTouchMove } = useShortcut(props, groupRef)\r\n    return { groupRef, onScroll, fixedTitle, currentIndex, fixedStyle, shortcutList, onShortcutTouchStart, onShortcutTouchMove, scrollRef }\r\n  }\r\n}\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n .index-list {\r\n    position: relative;\r\n    width: 100%;\r\n    height: 100%;\r\n    overflow: hidden;\r\n    background: $color-background;\r\n    .group {\r\n      padding-bottom: 30px;\r\n      .title {\r\n        height: 30px;\r\n        line-height: 30px;\r\n        padding-left: 20px;\r\n        position:sticky;\r\n        top: 0;\r\n        font-size: $font-size-small;\r\n        color: $color-text-l;\r\n        background: $color-highlight-background;\r\n      }\r\n      .item {\r\n        display: flex;\r\n        align-items: center;\r\n        padding: 20px 0 0 30px;\r\n        .avatar {\r\n          width: 50px;\r\n          height: 50px;\r\n          border-radius: 50%;\r\n        }\r\n        .name {\r\n          margin-left: 20px;\r\n          color: $color-text-l;\r\n          font-size: $font-size-medium;\r\n        }\r\n      }\r\n    }\r\n    .fixed{\r\n      position: absolute;\r\n      top: 0;\r\n      left: 0;\r\n      width: 100%;\r\n       .fixed-title {\r\n        height: 30px;\r\n        line-height: 30px;\r\n        padding-left: 20px;\r\n        font-size: $font-size-small;\r\n        color: $color-text-l;\r\n        background: $color-highlight-background;\r\n      }\r\n    }\r\n    .shortcut {\r\n      position: absolute;\r\n      right: 4px;\r\n      top: 50%;\r\n      transform: translateY(-50%);\r\n      width: 20px;\r\n      padding: 20px 0;\r\n      border-radius: 10px;\r\n      text-align: center;\r\n      background: $color-background-d;\r\n      font-family: Helvetica;\r\n      .item {\r\n        padding: 3px;\r\n        line-height: 1;\r\n        color: $color-text-l;\r\n        font-size: $font-size-small;\r\n        &.current {\r\n          color: $color-theme\r\n        }\r\n      }\r\n    }\r\n    }\r\n</style>\r\n","import { nextTick, ref, watch, computed } from 'vue'\r\nexport default function useFixed (props) {\r\n  const TITLE_HEIGHT = 30\r\n  const groupRef = ref(null)\r\n  const listHeights = ref([])\r\n  const scrollY = ref(0)\r\n  const currentIndex = ref(0)\r\n  const distance = ref(0)\r\n  const listHeightsVal = listHeights.value\r\n\r\n  const fixedStyle = computed(() => {\r\n    const distanceVal = distance.value\r\n    const diff = (distanceVal > 0 && distanceVal < TITLE_HEIGHT) ? distanceVal - TITLE_HEIGHT : 0\r\n    return {\r\n      transform: `translate3d(0,${diff}px,0)`\r\n    }\r\n  })\r\n  const fixedTitle = computed(() => {\r\n    if (scrollY.value < 0) {\r\n      return ''\r\n    }\r\n    const currentGroup = props.data[currentIndex.value]\r\n    return currentGroup ? currentGroup.title : ''\r\n  })\r\n  watch(() => props.data, async () => {\r\n    await nextTick()\r\n    caculate()\r\n  })\r\n  watch(scrollY, (newY) => {\r\n    for (let i = 0; i < listHeightsVal.length - 1; i++) {\r\n      const heightTop = listHeightsVal[i]\r\n      const heightBottom = listHeightsVal[i + 1]\r\n      if (newY >= heightTop && newY <= heightBottom) {\r\n        currentIndex.value = i\r\n        distance.value = heightBottom - newY\r\n      }\r\n    }\r\n  })\r\n  function caculate () {\r\n    const list = groupRef.value.children\r\n\r\n    let height = 0\r\n    listHeightsVal.length = 0\r\n    listHeightsVal.push(height)\r\n\r\n    for (let i = 0; i < list.length; i++) {\r\n      height += list[i].clientHeight\r\n      listHeightsVal.push(height)\r\n    }\r\n  }\r\n  function onScroll (pos) {\r\n    scrollY.value = -pos.y\r\n  }\r\n  return { groupRef, onScroll, fixedTitle, currentIndex, fixedStyle }\r\n}\r\n","import { ref, computed } from '@vue/runtime-core'\r\n\r\nexport default function useShortcut (props, groupRef) {\r\n  const ANCHOR_HEIGHT = 18\r\n  const scrollRef = ref(null)\r\n  const shortcutList = computed(() => {\r\n    return props.data.map((group) => {\r\n      return group.title\r\n    })\r\n  })\r\n  const touch = {}\r\n  function onShortcutTouchStart (e) {\r\n    const anchorIndex = parseInt(e.target.dataset.index)\r\n    touch.anchorIndex = anchorIndex\r\n    touch.y1 = e.touches[0].pageY\r\n    scrollTo(anchorIndex)\r\n  }\r\n  function onShortcutTouchMove (e) {\r\n    touch.y2 = e.touches[0].pageY\r\n    const delta = (touch.y2 - touch.y1) / ANCHOR_HEIGHT | 0\r\n    const anchorIndex = touch.anchorIndex + delta\r\n    scrollTo(anchorIndex)\r\n  }\r\n  function scrollTo (index) {\r\n    if (isNaN(index)) {\r\n      return\r\n    }\r\n    index = Math.max(0, Math.min(shortcutList.value.length - 1, index))\r\n    const targetEl = groupRef.value.children[index]\r\n    const scroll = scrollRef.value.scroll\r\n    scroll.scrollToElement(targetEl, 0)\r\n  }\r\n  return { shortcutList, onShortcutTouchStart, scrollRef, onShortcutTouchMove }\r\n}\r\n","import { render } from \"./indexList.vue?vue&type=template&id=4345f6b8&scoped=true\"\nimport script from \"./indexList.vue?vue&type=script&lang=js\"\nexport * from \"./indexList.vue?vue&type=script&lang=js\"\n\nimport \"./indexList.vue?vue&type=style&index=0&id=4345f6b8&lang=scss&scoped=true\"\nscript.render = render\nscript.__scopeId = \"data-v-4345f6b8\"\n\nexport default script","import { render } from \"./singer.vue?vue&type=template&id=660f5922&scoped=true\"\nimport script from \"./singer.vue?vue&type=script&lang=js\"\nexport * from \"./singer.vue?vue&type=script&lang=js\"\n\nimport \"./singer.vue?vue&type=style&index=0&id=660f5922&lang=scss&scoped=true\"\nscript.render = render\nscript.__scopeId = \"data-v-660f5922\"\n\nexport default script","export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--0-1!./indexList.vue?vue&type=style&index=0&id=4345f6b8&lang=scss&scoped=true\"","'use strict';\nvar $ = require('../internals/export');\nvar $map = require('../internals/array-iteration').map;\nvar arrayMethodHasSpeciesSupport = require('../internals/array-method-has-species-support');\n\nvar HAS_SPECIES_SUPPORT = arrayMethodHasSpeciesSupport('map');\n\n// `Array.prototype.map` method\n// https://tc39.es/ecma262/#sec-array.prototype.map\n// with adding support of @@species\n$({ target: 'Array', proto: true, forced: !HAS_SPECIES_SUPPORT }, {\n  map: function map(callbackfn /* , thisArg */) {\n    return $map(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--0-1!./singer.vue?vue&type=style&index=0&id=660f5922&lang=scss&scoped=true\""],"sourceRoot":""}